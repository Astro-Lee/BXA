
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>BXA/Sherpa &#8212; BXA (Bayesian X-ray Analysis) 3.3.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="BXA/Xspec" href="xspec-analysis.html" />
    <link rel="prev" title="Welcome to BXA’s documentation!" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="xspec-analysis.html" title="BXA/Xspec"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to BXA’s documentation!"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">BXA (Bayesian X-ray Analysis) 3.3.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="bxa-sherpa">
<h1>BXA/Sherpa<a class="headerlink" href="#bxa-sherpa" title="Permalink to this headline">¶</a></h1>
<p>Define your background model and source model as usual in sherpa.
Freeze the parameters you do not want to investigate. Make sure you set the parameter minimum and maximum values to appropriate (a priori reasonable) values.</p>
<div class="section" id="defining-priors">
<span id="sherpa-priors"></span><h2>Defining priors<a class="headerlink" href="#defining-priors" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># you can use automatic priors (uniform priors everywhere, within the parameters range)</span>
<span class="c1"># for this, all scale parameters (those with ampl or norm in their name)</span>
<span class="c1"># are converted to log-parameters</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="n">auto_reparametrize</span><span class="p">()</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">bxa</span><span class="o">.</span><span class="n">create_prior_function</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively (advanced), define priors manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># get parameters</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">,</span> <span class="n">param3</span><span class="p">]</span>
<span class="c1"># or just get all that are not linked or frozen</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">get_model</span><span class="p">()</span><span class="o">.</span><span class="n">pars</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">frozen</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">link</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>

<span class="n">priors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">priors</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bxa</span><span class="o">.</span><span class="n">create_jeffreys_prior_for</span><span class="p">(</span><span class="n">param1</span><span class="p">)]</span>
<span class="n">priors</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bxa</span><span class="o">.</span><span class="n">create_uniform_prior_for</span><span class="p">(</span><span class="n">param2</span><span class="p">)]</span>
<span class="n">priors</span> <span class="o">+=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># custom prior transformation (rarely desired)</span>
<span class="n">priorfunction</span> <span class="o">=</span> <span class="n">bxa</span><span class="o">.</span><span class="n">create_prior_function</span><span class="p">(</span><span class="n">priors</span> <span class="o">=</span> <span class="n">priors</span><span class="p">)</span>
</pre></div>
</div>
<dl class="function">
<dt id="bxa.sherpa.create_jeffreys_prior_for">
<code class="sig-prename descclassname">bxa.sherpa.</code><code class="sig-name descname">create_jeffreys_prior_for</code><span class="sig-paren">(</span><em class="sig-param">parameter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bxa/sherpa/priors.html#create_jeffreys_prior_for"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bxa.sherpa.create_jeffreys_prior_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Use for scale variables (order of magnitude)
The Jeffreys prior gives equal weight to each order of magnitude between the
minimum and maximum value. Flat in logarithmic scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parameter</strong> – Parameter to create a prior for. E.g. xspowerlaw.mypowerlaw.norm</p>
</dd>
</dl>
<p>It is usually easier to create an ancillary parameter, and link the 
actual parameter, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sherpa.models.parameter</span> <span class="k">import</span> <span class="n">Parameter</span>
<span class="n">lognorm</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">modelname</span><span class="o">=</span><span class="s1">&#39;mycomponent&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lognorm&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">powerlaw</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">lognorm</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="bxa.sherpa.create_uniform_prior_for">
<code class="sig-prename descclassname">bxa.sherpa.</code><code class="sig-name descname">create_uniform_prior_for</code><span class="sig-paren">(</span><em class="sig-param">parameter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bxa/sherpa/priors.html#create_uniform_prior_for"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bxa.sherpa.create_uniform_prior_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Use for location variables (position)
The uniform prior gives equal weight in non-logarithmic scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parameter</strong> – Parameter to create a prior for. E.g. xspowerlaw.mypowerlaw.PhoIndex</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="bxa.sherpa.create_prior_function">
<code class="sig-prename descclassname">bxa.sherpa.</code><code class="sig-name descname">create_prior_function</code><span class="sig-paren">(</span><em class="sig-param">priors=[]</em>, <em class="sig-param">parameters=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bxa/sherpa/priors.html#create_prior_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bxa.sherpa.create_prior_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the prior transformations into a single function for pymultinest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>priors</strong> – individual prior transforms to combine into one function.
If priors is empty, uniform priors are used on all passed parameters</p></li>
<li><p><strong>parameters</strong> – If priors is empty, specify the list of parameters.
Uniform priors will be created for them.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="running-the-analysis">
<span id="sherpa-run"></span><h2>Running the analysis<a class="headerlink" href="#running-the-analysis" title="Permalink to this headline">¶</a></h2>
<p>You need to specify a prefix, called <em>outputfiles_basename</em> where the files are stored.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># see the pymultinest documentation for all options</span>
<span class="n">bxa</span><span class="o">.</span><span class="n">nested_run</span><span class="p">(</span><span class="n">prior</span> <span class="o">=</span> <span class="n">priorfunction</span><span class="p">,</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">,</span>
             <span class="n">resume</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">outputfiles_basename</span> <span class="o">=</span> <span class="s2">&quot;testbxa_&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="function">
<dt id="bxa.sherpa.nested_run">
<code class="sig-prename descclassname">bxa.sherpa.</code><code class="sig-name descname">nested_run</code><span class="sig-paren">(</span><em class="sig-param">id=None</em>, <em class="sig-param">otherids=()</em>, <em class="sig-param">prior=None</em>, <em class="sig-param">parameters=None</em>, <em class="sig-param">sampling_efficiency=0.3</em>, <em class="sig-param">evidence_tolerance=0.5</em>, <em class="sig-param">n_live_points=400</em>, <em class="sig-param">outputfiles_basename='chains/'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bxa/sherpa.html#nested_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bxa.sherpa.nested_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the Bayesian analysis with specified parameters+transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – See the sherpa documentation of calc_stat.</p></li>
<li><p><strong>otherids</strong> – See the sherpa documentation of calc_stat.</p></li>
<li><p><strong>prior</strong> – prior function created with create_prior_function.</p></li>
<li><p><strong>parameters</strong> – List of parameters to analyse.</p></li>
<li><p><strong>outputfiles_basename</strong> – prefix for output filenames.</p></li>
</ul>
</dd>
</dl>
<p>If prior is None, uniform priors are used on the passed parameters.
If parameters is also None, all thawed parameters are used.</p>
<p>The remainder are multinest arguments (see PyMultiNest and MultiNest documentation!)
n_live_points: 400 are often enough</p>
<p>For quick results, use sampling_efficiency = 0.8, n_live_points = 50, 
evidence_tolerance = 5. 
The real results must be estimated with sampling_efficiency = 0.3,
otherwise it is not reliable.</p>
</dd></dl>

<dl class="function">
<dt id="bxa.sherpa.set_best_fit">
<code class="sig-prename descclassname">bxa.sherpa.</code><code class="sig-name descname">set_best_fit</code><span class="sig-paren">(</span><em class="sig-param">id=None</em>, <em class="sig-param">otherids=()</em>, <em class="sig-param">parameters=None</em>, <em class="sig-param">outputfiles_basename='chains/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bxa/sherpa.html#set_best_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bxa.sherpa.set_best_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets model to the best fit values.</p>
</dd></dl>

</div>
<div class="section" id="marginal-plots">
<span id="sherpa-analyse"></span><h2>Marginal plots<a class="headerlink" href="#marginal-plots" title="Permalink to this headline">¶</a></h2>
<p>Plot and analyse the results. PyMultiNest comes in handy at this point to
produce a number of plots and summaries.</p>
<p>On the shell, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ multinest_marginals.py &quot;testbxa_&quot;
</pre></div>
</div>
<p>The <a class="reference external" href="https://github.com/JohannesBuchner/PyMultiNest/blob/master/multinest_marginals.py">multinest_marginals.py</a>
utility is installed with PyMultiNest, for instance into ~/.local/bin/.</p>
</div>
<div class="section" id="error-propagation">
<h2>Error propagation<a class="headerlink" href="#error-propagation" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">pymultinest.Analyzer.equal_weighted_posterior()</span></code> provides access to the posterior samples (similar to a Markov Chain).
Use these to propagate errors:</p>
<ul class="simple">
<li><p>For every row in the chain, compute the quantity of interest</p></li>
<li><p>Then, make a histogram of the results, or compute mean and standard deviations.</p></li>
</ul>
<p>This preserves the structure of the uncertainty (multiple modes, degeneracies, etc.)</p>
<p>You can also access the output directly and compute other quantities:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymultinest</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">pymultinest</span><span class="o">.</span><span class="n">analyse</span><span class="o">.</span><span class="n">Analyzer</span><span class="p">(</span><span class="n">n_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">),</span>
        <span class="n">outputfiles_basename</span> <span class="o">=</span> <span class="s1">&#39;testbxa_&#39;</span><span class="p">)</span>

<span class="n">chain</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_equal_weighted_posterior</span><span class="p">()</span>

<span class="nb">print</span> <span class="n">chain</span>
</pre></div>
</div>
<p>BXA also allows you to compute the fluxes corresponding to the
parameter estimation, giving the correct probability distribution on the flux.
With distance information (fixed value or distribution), you can later infer
the correct luminosity distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span> <span class="o">=</span> <span class="n">pyblocxs</span><span class="o">.</span><span class="n">mn</span><span class="o">.</span><span class="n">get_distribution_with_fluxes</span><span class="p">(</span><span class="n">lo</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">outputfiles_basename</span> <span class="o">=</span> <span class="s1">&#39;testbxa_&#39;</span><span class="p">)</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">out</span> <span class="o">+</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;dist.txt&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
<dl class="function">
<dt id="bxa.sherpa.get_distribution_with_fluxes">
<code class="sig-prename descclassname">bxa.sherpa.</code><code class="sig-name descname">get_distribution_with_fluxes</code><span class="sig-paren">(</span><em class="sig-param">id=None</em>, <em class="sig-param">otherids=()</em>, <em class="sig-param">lo=None</em>, <em class="sig-param">hi=None</em>, <em class="sig-param">parameters=None</em>, <em class="sig-param">outputfiles_basename='chains/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bxa/sherpa.html#get_distribution_with_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bxa.sherpa.get_distribution_with_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of equally weighted posterior samples (parameter values) with two 
additional columns: the photon fluxes and the energy fluxes.</p>
<p>The values will be correctly distributed according to the
analysis run before.</p>
</dd></dl>

</div>
<div class="section" id="model-comparison">
<span id="sherpa-models"></span><h2>Model comparison<a class="headerlink" href="#model-comparison" title="Permalink to this headline">¶</a></h2>
<p><em>examples/model_compare.py</em> shows an example of model selection. Keep in mind what model prior you would like to use.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Case 1: Multiple models, want to find one best one to use from there on:</dt><dd><ul>
<li><p>follow <em>examples/model_compare.py</em>, and pick the model with the highest evidence</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Case 2: Simpler and more complex models, want to find out which complexity is justified:</dt><dd><ul>
<li><p>follow <em>examples/model_compare.py</em>, and keep the models above a certain threshold</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Case 3: Multiple models which could be correct, only interested in a parameter</dt><dd><ul>
<li><p>Marginalize over the models: Use the posterior samples from each model, and weigh them by the
relative probability of the models (weight = exp(lnZ))</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jbuchner@ds42 $ python model_compare.py absorbed- line- simplest-

Model comparison
****************

model simplest- : log10(Z) = -1632.7  XXX ruled out
model absorbed- : log10(Z) =    -7.5  XXX ruled out
model line-     : log10(Z) =     0.0    &lt;-- GOOD

The last, most likely model was used as normalization.
Uniform model priors are assumed, with a cut of log10(30) to rule out models.

jbuchner@ds42 $
</pre></div>
</div>
<p>Here, the probability of the second-best model, “absorbed”, is <span class="math notranslate nohighlight">\(10^7.5\)</span> times
less likely than the model “line”. As this exceeds our threshold (by a lot!)
we can claim the detection of an iron line!</p>
</div>
<div class="section" id="experiment-design">
<span id="sherpa-design"></span><h2>Experiment design<a class="headerlink" href="#experiment-design" title="Permalink to this headline">¶</a></h2>
<p>We want to to evaluate whether a planned experiment can detect features or constrain parameters,
i.e. determine the discriminatory power of future configurations/surveys/missions.</p>
<p>For this, simulate a few spectra using the appropriate response.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Case 1: Can the experiment constrain the parameters?</dt><dd><ul>
<li><p>Analyse and check what fraction of the posterior samples lie inside/outside the region of interest.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Case 2: Can the experiment distinguish between two models?</dt><dd><ul>
<li><p>Model selection as above.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Case 3: Which sources (redshift range, luminosity, etc) can be distinguished?</dt><dd><ul>
<li><p>Compute a grid of spectra. Do model selection at each point in the grid.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="model-discovery">
<span id="sherpa-qq"></span><h2>Model discovery<a class="headerlink" href="#model-discovery" title="Permalink to this headline">¶</a></h2>
<p>Is the model the right one? Is there more in the data? These questions can not
be answered in a statistical way, <strong>but</strong> what we can do is</p>
<ol class="arabic simple">
<li><p>generate ideas on what models could fit better</p></li>
<li><p>test those models for significance with model selection</p></li>
</ol>
<p>For the first point, <strong>Quantile-Quantile plots</strong> provide a unbinned, less noisy alternative to
residual plots.</p>
<img alt="_images/absorbed-qq_model_deviations.png" src="_images/absorbed-qq_model_deviations.png" />
<img alt="_images/absorbed-convolved_posterior.png" src="_images/absorbed-convolved_posterior.png" />
<p>QQ plot example (left), with the corresponding spectrum for comparison (right).</p>
<p>In these plots, for each energy the number of counts observed with lower energy
are plotted on one axis, while the predicted are on the other axis.
If model and data agree perfectly, this would be a straight line.
Deviances are indications of possible mis-fits.</p>
<p>This example is almost a perfect fit!
You can see a offset growing at 6-7 keV, which remains at higher energies.
This indicates that the data has more counts than the model there.</p>
<p>As the growth is in a S-shape, it is probably a Gaussian (see its <a class="reference external" href="https://en.wikipedia.org/wiki/Normal_distribution">cumulative density function</a>).</p>
<p>Refer to the appendix of the <a class="reference external" href="cite">accompaning paper</a> for more examples.</p>
<p>The <em>qq</em> function in the <em>qq</em> module allows you to create such plots easily, by
exporting the cumulative functions into a file.</p>
<dl class="function">
<dt id="bxa.sherpa.qq.qq_export">
<code class="sig-prename descclassname">bxa.sherpa.qq.</code><code class="sig-name descname">qq_export</code><span class="sig-paren">(</span><em class="sig-param">id=None</em>, <em class="sig-param">bkg=False</em>, <em class="sig-param">outfile='qq.txt'</em>, <em class="sig-param">elow=None</em>, <em class="sig-param">ehigh=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bxa/sherpa/qq.html#qq_export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bxa.sherpa.qq.qq_export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export Q-Q plot into a file for plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – spectrum id to use (see get_bkg_plot/get_data_plot)</p></li>
<li><p><strong>bkg</strong> – whether to use get_bkg_plot or get_data_plot</p></li>
<li><p><strong>outfile</strong> – filename to write results into</p></li>
<li><p><strong>elow</strong> – low energy limit</p></li>
<li><p><strong>ehigh</strong> – low energy limit</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qq</span><span class="o">.</span><span class="n">qq_export</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;my_bg_qq&#39;</span><span class="p">,</span> <span class="n">elow</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ehigh</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<p>Refer to the <a class="reference internal" href="index.html#cite"><span class="std std-ref">accompaning paper</span></a>, which gives an introduction and
detailed discussion on the methodology.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">BXA/Sherpa</a><ul>
<li><a class="reference internal" href="#defining-priors">Defining priors</a></li>
<li><a class="reference internal" href="#running-the-analysis">Running the analysis</a></li>
<li><a class="reference internal" href="#marginal-plots">Marginal plots</a></li>
<li><a class="reference internal" href="#error-propagation">Error propagation</a></li>
<li><a class="reference internal" href="#model-comparison">Model comparison</a></li>
<li><a class="reference internal" href="#experiment-design">Experiment design</a></li>
<li><a class="reference internal" href="#model-discovery">Model discovery</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to BXA’s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="xspec-analysis.html"
                        title="next chapter">BXA/Xspec</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/sherpa-analysis.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="xspec-analysis.html" title="BXA/Xspec"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to BXA’s documentation!"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">BXA (Bayesian X-ray Analysis) 3.3.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2020, Johannes Buchner.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>